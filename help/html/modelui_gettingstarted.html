
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ModelUI - Getting Started</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-01-15"><meta name="DC.source" content="modelui_gettingstarted.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>ModelUI - Getting Started</h1><!--introduction--><p>The steps below outline how to setup a bespoke application of ModelUI by modifying the default UI. How to develop more complex UIs is explained more in the <a href="matlab:open_manual">ModelUI manual</a>.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Main UI</a></li><li><a href="#3">Data import</a></li><li><a href="#4">Data properties</a></li><li><a href="#5">Models</a></li></ul></div><div><ol><li>Decide on what components are needed. These might include: <a href="br">br</a>   o UI - the main interface for the application  <a href="br">br</a>   o Data import - load different types of data <a href="br">br</a>   o Properties input - define properties needed for application <a href="br">br</a>   o Model(s) - the models to be run by the application.  <a href="br">br</a></li><li>Give names to each component, e.g.: <a href="br">br</a>   ModelUI, demoData, demoProps, demoModel</li><li>Copy the class templates for the components from here to your working folder</li><li>Create classes for each component by editing the templates as set out for each template below.</li></ol></div><h2 id="2">Main UI</h2><p>Text</p><pre class="language-matlab">
<span class="keyword">classdef</span> UseUI_template &lt; ModelUI
    <span class="comment">% Main UI for the &lt;AppName&gt; model, which implements the </span>
    <span class="comment">% ModelUI and muiModelUI classes to define main menus.</span>
    <span class="comment">%----------------------------------------------------------------------</span>
    <span class="comment">%</span>
    <span class="comment">% AUTHOR</span>
    <span class="comment">% Ian Townend</span>
    <span class="comment">%</span>
    <span class="comment">% COPYRIGHT</span>
    <span class="comment">% CoastalSEA, (c) 2019</span>
    <span class="comment">%----------------------------------------------------------------------</span>
    <span class="comment">%  </span>
    <span class="keyword">properties</span>
        vNumber = <span class="string">'1.0'</span>
        vDate   = <span class="string">'Jan 2019'</span>
        <span class="comment">%additional handles to those defined in ModelUI</span>
        <span class="comment">%XXXX  class uses h_InputData</span>
        <span class="comment">%YYYY  class uses h_ImportedData</span>
        <span class="comment">%ZZZZ  class uses h_Model                          </span>
    <span class="keyword">end</span>
    
    <span class="keyword">methods</span> (Static)
        <span class="keyword">function</span> obj = NewUItemplate
            <span class="comment">%model constructor function  </span>
            <span class="comment">%NB setGUI is called by ModelUI constructor              </span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="comment">%% ---Overload functions in ModelUI to provide required user interface </span>
    <span class="keyword">methods</span>
        <span class="keyword">function</span> obj = setGUI(obj,~)
            <span class="comment">%initialise standard figure and menus</span>
            obj.FigTitle = sprintf(<span class="string">'%s - Version: %s;  Date: %s'</span>,<span class="keyword">...</span>
                                   <span class="string">'NewUItemplate'</span>,obj.vNumber,obj.vDate);
            obj.ModelLogo = <span class="string">'NewUItemplate_logo.jpg'</span>;
            obj.ModelHelp = <span class="string">'NewUItemplate_help.txt'</span>;
            obj.ModelInputs.Model = {<span class="string">'h_InputData'</span>};                                
            obj.SaveDataString = <span class="string">'h_InputData'</span>;            
            obj.NumTabs.Plot = 2;       <span class="comment">%1=XY only; 2=XY,XYZ; 3=Animate</span>
            obj = initialiseUI(obj);    <span class="comment">%initialise menus and tabs</span>
            <span class="comment">%if using standard inputProps or runModel functions, define</span>
            <span class="comment">%ModelSpec for ModelInput, DataInput and RunModel as required</span>
            <span class="comment">%e.g. </span>
            <span class="comment">%obj.ModelSpec.ModelInput = 'NewInput.setInputData';</span>
            <span class="comment">%obj.ModelSpec.RunModel = 'NewModel.runModel';</span>
            <span class="comment">%if required call setAdditionalMenus(obj) here  </span>
        <span class="keyword">end</span> 
<span class="comment">%%</span>
        <span class="keyword">function</span> obj = setClassHandles(obj)
            <span class="comment">%cell array that defines the assignment of each class used in</span>
            <span class="comment">%the model to a handle. Format {handle name, class name;...}</span>
            modelhandles = {<span class="string">'h_InputData'</span>,<span class="string">'XXXX'</span>;<span class="keyword">...</span>
                            <span class="string">'h_ImportedData'</span>,<span class="string">'YYYY'</span>;<span class="keyword">...</span>
                            <span class="string">'h_Model'</span>,<span class="string">'ZZZZ'</span>};
            obj.ModelHandles = vertcat(obj.ModelHandles,modelhandles);
            <span class="comment">%setClassHandles is called by GUIinterface.setModelHandles</span>
            <span class="comment">%where obj.ModelHandles is converted to a table with variables</span>
            <span class="comment">%handle and class. If ModelSpec is used then classes are</span>
            <span class="comment">%obtained from the model specification</span>
        <span class="keyword">end</span>
<span class="comment">%%</span>
        <span class="keyword">function</span> setAppTabs(gobj)
            <span class="comment">%default tabs for Scenarios (list of model runs), summary of </span>
            <span class="comment">%current model parameters and Help</span>
            uitab(gobj.GuiTabs,<span class="keyword">...</span>
                <span class="string">'Title'</span>,<span class="string">' Inputs '</span>,<span class="string">'Tag'</span>,<span class="string">'Inputs'</span>,<span class="keyword">...</span>
                <span class="string">'ButtonDownFcn'</span>,@gobj.ModelSummary);
            <span class="comment">%initialise tabs for specific model</span>
            uitab(gobj.GuiTabs,<span class="keyword">...</span>
                <span class="string">'Title'</span>,<span class="string">' Plot '</span>,<span class="string">'Tag'</span>,<span class="string">'Plot'</span>,<span class="keyword">...</span>
                <span class="string">'ButtonDownFcn'</span>,@gobj.getTabData); 
            <span class="comment">%default tab for Help</span>
            uitab(gobj.GuiTabs,<span class="keyword">...</span>
                <span class="string">'Title'</span>,<span class="string">'  Help  '</span>,<span class="string">'Tag'</span>,<span class="string">'Help'</span>,<span class="keyword">...</span>
                <span class="string">'ButtonDownFcn'</span>,@gobj.Help);  
        <span class="keyword">end</span>
<span class="comment">%%</span>
        <span class="keyword">function</span> props = getTabProperties(~)
            <span class="comment">%define the tab and position to display class data tables</span>
            <span class="comment">%props format: {class name, tab tag name, position, ...</span>
            <span class="comment">%               column width, table title}                 </span>
            props = {<span class="keyword">...</span>
                <span class="string">'XXXX'</span>,<span class="string">'Inputs'</span>,[0.95,0.48],{180,60},<span class="string">'Some data:'</span>;<span class="keyword">...</span>
                <span class="string">'YYYY'</span>,<span class="string">'Inputs'</span>,[0.36,0.58],{240,60},<span class="string">'Some other input:'</span>};
        <span class="keyword">end</span>        
    <span class="keyword">end</span>    
<span class="comment">%% </span>
<span class="comment">%----Functions called by menu-&gt;  </span>
    <span class="keyword">methods</span> (Access=protected)
        <span class="keyword">function</span> MenuDef = setupMenu(gobj)
            <span class="comment">%define Parent menu for Setup</span>
            MenuDef.MenuLabel = {<span class="string">'Setup'</span>};
            MenuDef.MenuList = {<span class="string">'Input Data'</span>,<span class="string">'Run Parameters'</span>};
            MenuDef.MenuCallback = {<span class="string">'gcbo;'</span>,@gobj.runProps};
        <span class="keyword">end</span>
<span class="comment">%%</span>
        <span class="keyword">function</span> MenuDef = inputdataSubMenu(gobj)
            <span class="comment">%define subParent menu for Setup&gt;Input Data</span>
            <span class="comment">%remove Reference Data from the menu</span>
            MenuDef.MenuLabel = {<span class="string">'Setup'</span>};
            MenuDef.MenuList = {<span class="string">'Model Data'</span>,<span class="string">'Model Constants'</span>};                
            MenuDef.MenuCallback = repmat({@gobj.inputProps},[1,2]);
        <span class="keyword">end</span>     
<span class="comment">%%</span>
        <span class="keyword">function</span> inputProps(gobj,src,~)
            <span class="comment">%model specific data setup function calls</span>
            <span class="keyword">switch</span> src.Label
                <span class="keyword">case</span> <span class="string">'Model Data'</span>
                    tabname = callClassFunction(gobj,<span class="keyword">...</span>
                                      <span class="string">'InputData'</span>,<span class="string">'setInputData'</span>,true);
                    tabsrc = findobj(gobj.GuiTabs,<span class="string">'Tag'</span>,tabname);
                    ModelSummary(gobj,tabsrc);
                <span class="keyword">case</span> <span class="string">'Model Constants'</span>
                    gobj.Constants = ConstantData.editConstantData(gobj);
            <span class="keyword">end</span>
        <span class="keyword">end</span>    
<span class="comment">%%                </span>
        <span class="keyword">function</span> runProps(gobj,~,~) 
            <span class="comment">%callback functions for model run properties</span>
            <span class="comment">%add or amend run time properties for model</span>
            tabname = callClassFunction(gobj,<span class="keyword">...</span>
                                      <span class="string">'InRunProps'</span>,<span class="string">'setInRunProps'</span>,true);
            tabsrc = findobj(gobj.GuiTabs,<span class="string">'Tag'</span>,tabname);
            ModelSummary(gobj,tabsrc);
        <span class="keyword">end</span>  
<span class="comment">%% </span>
<span class="comment">%----Model Run Menu--------------------------------------------------------</span>
<span class="comment">%----Functions called by menu-&gt;    </span>
        <span class="keyword">function</span> runModel(gobj,src,~)
            <span class="keyword">switch</span> src.Label
                <span class="keyword">case</span> <span class="string">'Run Model'</span>
                    callClassFunction(gobj,<span class="string">'NewModel'</span>,<span class="string">'runNewModel'</span>);  
                <span class="keyword">case</span> <span class="string">'Derive Output'</span>
                    gobj.GuiManip = DataManip.getDataManipGui(gobj);   
            <span class="keyword">end</span>            
        <span class="keyword">end</span>   
    <span class="keyword">end</span>
<span class="keyword">end</span>    
    
    
    
    
    
    
    
    
    
    

</pre><h2 id="3">Data import</h2><p>text</p><pre class="language-matlab">
<span class="keyword">classdef</span> DataClassTemplate &lt; TSDataSet <span class="comment">%or DSDataSet for timesereis data</span>
<span class="comment">%</span>
<span class="comment">%-------class help------------------------------------------------------</span>
<span class="comment">% NAME</span>
<span class="comment">%   ModleClassTemplate.m</span>
<span class="comment">% PURPOSE</span>
<span class="comment">%   Class description - Class for DataSet XXXXX to be run from ModelUI</span>
<span class="comment">%</span>
<span class="comment">% SEE ALSO</span>
<span class="comment">%</span>
<span class="comment">% Author: Ian Townend</span>
<span class="comment">% CoastalSEA (c)June 2020</span>
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="comment">%         </span>
    <span class="keyword">properties</span> (Hidden)
        <span class="comment">%Default properties defined in XXDataSet. </span>
        <span class="comment">%Timeseries data is held in property 'mtsc' defined in TSDataSet</span>
        <span class="comment">%Additional properties:</span>
        <span class="comment">%Data linked to a class data record that needs to be amended if </span>
        <span class="comment">%the record is deleted. </span>
        <span class="comment">%Format is: {handle, id used in Cases, other properties}. </span>
        <span class="comment">%Other than handle, the variable names need to agree with</span>
        <span class="comment">%variables in the InputFile class, or equivalent</span>
        PropertyLink = {<span class="string">'h_InputFile'</span>,<span class="string">'idDataSet'</span>,<span class="string">'DataFile'</span>}; 
    <span class="keyword">end</span>
    
    <span class="keyword">properties</span> (Transient)
        <span class="comment">%Additional properties:</span>
    <span class="keyword">end</span>
    
    <span class="keyword">properties</span> 
        <span class="comment">%Additional properties:</span>
    <span class="keyword">end</span>
        
    <span class="keyword">methods</span>  
        <span class="keyword">function</span> obj = DataClassTemplate(mobj)
            <span class="comment">%constructor to initialise object</span>
            obj.ResDef = mobj.Constants.ResDef; 
            <span class="comment">%initialise list of available input file formats. Format is:</span>
            <span class="comment">%{'label 1','function name 1';'label 2','function name 2'; etc}</span>
            obj.DataFormats = {<span class="string">'Type1 format'</span>,<span class="string">'function name 1'</span>;<span class="keyword">...</span>
                               <span class="string">'Type 2 format'</span>,<span class="string">'function name 2'</span>};
        <span class="keyword">end</span>
    <span class="keyword">end</span>  
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="comment">%   functions to read data from file and load as a timeseries</span>
<span class="comment">%   default function for loadData, addData and dataQC are in TSDataSet</span>
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="keyword">end</span>

</pre><h2 id="4">Data properties</h2><p>For each set of <i>input properties</i>, define a classname and edit the template where indicated using the classname. Define the <i>input properties</i> required in the properties block and provide a description (used in the input UI) for each property as a cell array of strings in the PropertyLabels property.</p><pre class="language-matlab">
<span class="keyword">classdef</span> PropsInput_template &lt; PropertyInterface            <span class="comment">% &lt;&lt; Edit to classname</span>
<span class="comment">%</span>
<span class="comment">%-------class help------------------------------------------------------===</span>
<span class="comment">% NAME</span>
<span class="comment">%   PropsInput_template.m</span>
<span class="comment">% PURPOSE</span>
<span class="comment">%   Class for input properties for some component of the UI application</span>
<span class="comment">% USAGE</span>
<span class="comment">%   obj = PropsInput_template.setPropsInput(mobj); %mobj is a handle to Main UI</span>
<span class="comment">% SEE ALSO</span>
<span class="comment">%   inherits muiPropertyUI</span>
<span class="comment">%</span>
<span class="comment">% Author: Ian Townend</span>
<span class="comment">% CoastalSEA (c) Jan 2021</span>
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="comment">%      </span>
    <span class="keyword">properties</span> (Hidden)
        <span class="comment">%abstract properties in PropertyInterface to define input variables</span>
        PropertyLabels = {<span class="string">'Variable 1 short description'</span>,<span class="keyword">...</span><span class="comment"> % &lt;&lt; Edit to property descriptions</span>
                          <span class="string">'Variable 2 short description'</span>,<span class="keyword">...</span>
                          <span class="string">'etc'</span>};
        <span class="comment">%abstract properties in PropertyInterface for tab display</span>
        TabDisplay   <span class="comment">%structure defines how the property table is displayed </span>
    <span class="keyword">end</span>
    
    <span class="keyword">properties</span>
        Variable_1                <span class="comment">%definition of variable 1  % &lt;&lt; Edit to property names</span>
        Variable_2                <span class="comment">%definition of variable 2</span>
        etc   <span class="comment">%there should be as many properties as labels</span>
    <span class="keyword">end</span>    

<span class="comment">%%   </span>
    <span class="keyword">methods</span> (Access=protected)
        <span class="keyword">function</span> obj = PropsInput_template(mobj)             <span class="comment">% &lt;&lt; Edit to classname</span>
            <span class="comment">%constructor code:            </span>
            <span class="comment">%values defined in UI function setTabProperties used to assign</span>
            <span class="comment">%the tabname and position on tab for the data to be displayed</span>
            classname = metaclass(obj).Name;
            obj = setTabProps(obj,mobj,classname);  <span class="comment">%muiPropertyUI fcn</span>
            
            <span class="comment">%to use non-numeric entries then one can either pre-assign </span>
            <span class="comment">%the values in properties defintion, above, or specity the </span>
            <span class="comment">%PropertyType as a cell array, e.g.:</span>
            <span class="comment">% obj.PropertyType = [{'datetime','string','logical'},...</span>
            <span class="comment">%                                       repmat({'double'},1,8)];</span>
        <span class="keyword">end</span> 
    <span class="keyword">end</span>
<span class="comment">%%  </span>
    <span class="keyword">methods</span> (Static)  
        <span class="keyword">function</span> obj = setPropsInput(mobj,editflag)
            <span class="comment">%gui for user to set Property Input values</span>
            classname = <span class="string">'PropsInput_template'</span>;               <span class="comment">% &lt;&lt;Edit to classname</span>
            <span class="keyword">if</span> isfield(mobj.Inputs,classname) &amp;&amp; <span class="keyword">...</span>
                            isa(mobj.Inputs.(classname),classname)
                obj = mobj.Inputs.(classname);  
            <span class="keyword">else</span>
                obj = DiffPropsInput(mobj);  <span class="comment">%instanstiate class instance</span>
            <span class="keyword">end</span>
            <span class="comment">%use muiPropertyUI function to generate UI</span>
            <span class="keyword">if</span> nargin&lt;2 || editflag
                <span class="comment">%add nrec to limit length of props UI (default=12)</span>
                obj = editProperties(obj);  
                <span class="comment">%add any additional manipulation of the input here</span>
            <span class="keyword">end</span>
            mobj.Inputs.(classname) = obj;
        <span class="keyword">end</span>     
    <span class="keyword">end</span>
<span class="comment">%%        </span>
        <span class="comment">%add other functions to operate on properties as required   </span>
<span class="keyword">end</span>

</pre><h2 id="5">Models</h2><p>text</p><pre class="language-matlab">
<span class="keyword">classdef</span> CT_Vulnerability &lt; DSDataSet <span class="comment">%or TSDataSet for timesereis data</span>
<span class="comment">%</span>
<span class="comment">%-------class help------------------------------------------------------</span>
<span class="comment">% NAME</span>
<span class="comment">%   ModleClassTemplate.m</span>
<span class="comment">% PURPOSE</span>
<span class="comment">%   Class description - Class for Model XXXXX to be run from ModelUI</span>
<span class="comment">%</span>
<span class="comment">% SEE ALSO</span>
<span class="comment">%</span>
<span class="comment">% Author: Ian Townend</span>
<span class="comment">% CoastalSEA (c)June 2020</span>
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="comment">%     </span>
    <span class="keyword">properties</span>
        <span class="comment">%Default properties defined in XXDataSet. </span>
        <span class="comment">%Timeseries datasets held in property 'mtsc' defined in TSDataSet</span>
        <span class="comment">%Table datasets held in property ModelData defined in DSDataSett</span>
        <span class="comment">%Additional properties:  </span>
        
    <span class="keyword">end</span>
<span class="comment">%%    </span>
    <span class="keyword">methods</span> (Access=private)  
        <span class="keyword">function</span> obj = ModelClassTemplate(mobj)
            <span class="comment">%constructor to initialise object</span>
            <span class="comment">%Define ResDef</span>
            r = mobj.Constants.ResDef;
            r.DataVar   = {<span class="string">'ModelData'</span>};  <span class="comment">%property for model data in Model class</span>
            r.AdnOutVar = {<span class="string">'AddnProps'</span>};  <span class="comment">%property for additional properties in Model class</span>
            r.varNames  = {<span class="string">'var1'</span>,<span class="string">'var2'</span>,<span class="string">'etc'</span>};          <span class="comment">%variable names</span>
            r.varDesc   = {<span class="string">'var1desc'</span>,<span class="string">'var2desc'</span>,<span class="string">'etc'</span>};  <span class="comment">%variable descriptions</span>
            r.varUnits  = {<span class="string">'units1'</span>,<span class="string">'units2'</span>,<span class="string">'etc'</span>};      <span class="comment">%variable units    </span>
            r.varLabels = {<span class="string">'var1label'</span>,<span class="string">'var2label'</span>,<span class="string">'etc'</span>};<span class="comment">%variable plot axis labels</span>
            r.xyzDesc   = {<span class="string">'Xdesc'</span>,<span class="string">'Ydesc'</span>,<span class="string">'Zdesc'</span>};      <span class="comment">%XYZ descriptions</span>
            r.xyzUnits  = {<span class="string">'Xunits'</span>,<span class="string">'Yunits'</span>,<span class="string">'Zunits'</span>};   <span class="comment">%XYZ units       </span>
            r.xyzLabels = {<span class="string">'Xlabel'</span>,<span class="string">'Ylabel'</span>,<span class="string">'Zlabel'</span>};   <span class="comment">%XYZ axis plot label</span>
            r.rowDesc   = {<span class="string">'Time'</span>};       <span class="comment">%key word used to identify time data</span>
            r.rowUnits  = {<span class="string">'time units'</span>}; <span class="comment">%time units (eg 'd','h','s')</span>
            r.rowLabels = {<span class="string">'Time (s)'</span>};   <span class="comment">%time axis plot label</span>
            r.rowFormat = {<span class="string">'dd-MMM-uuuu HH:mm:ss.SSS'</span>}; <span class="comment">%format used for time data</span>
            r.xyDefault = {<span class="string">'Time'</span>};      <span class="comment">%default X-axis; can be 'Time','X','Y',or Z'</span>
            r.Type      = {<span class="string">'model'</span>};     <span class="comment">%data type (model, data, etc for partitioning tab display)</span>
            r.Style     = {<span class="string">'Single'</span>};  <span class="comment">%write results to Excel spreadsheet as 'Single'or 'Multiple' </span>
            obj.ResDef = r;   
            <span class="comment">%Set InputHandles for input data required by model</span>
            <span class="comment">%(NB not required for imported data sets)</span>
            obj.InputHandles = mobj.ModelInputs.ModelClassTemplate;
        <span class="keyword">end</span>
    <span class="keyword">end</span>    
<span class="comment">%%</span>
    <span class="keyword">methods</span> (Static)        
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="comment">% Model implementation</span>
<span class="comment">%--------------------------------------------------------------------------         </span>
        <span class="keyword">function</span> obj = runModel(mobj)
            <span class="comment">%function to run a specific model</span>
            handle = getClassHandle(mobj,<span class="string">'ModelClassTemplate'</span>);
            <span class="keyword">if</span> isa(mobj.(handle),<span class="string">'ModelClassTemplate'</span>)
                obj = mobj.(handle);
                irec = length(mobj.(handle).ModelData)+1;
            <span class="keyword">else</span>
                obj = ModelClassTemplate(mobj);         <span class="comment">%instantiate object</span>
                irec = 1;
            <span class="keyword">end</span>
            <span class="comment">%now check that the input data has been entered</span>
            <span class="comment">%isValidModel checks the InputHandles defined in ModelUI</span>
            <span class="keyword">if</span> ~isValidModel(mobj,obj.InputHandles)  
                warndlg(<span class="string">'Use Setup to define model input parameters'</span>);
                <span class="keyword">return</span>;
            <span class="keyword">end</span>
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="comment">% Model code</span>
<span class="comment">%--------------------------------------------------------------------------</span>
            inp = mobj.(getClassHandle(mobj,<span class="string">'SomeInputData'</span>));
            
            <span class="comment">%&lt;model code or function call&gt;</span>
            
            <span class="comment">%create table with assignments as needed</span>
            newds = setCollection(obj,results,<span class="keyword">...</span>
                        <span class="string">'xyzData'</span>, xycoords,<span class="keyword">...</span>
                        <span class="string">'rowNames'</span>,modeltime,<span class="keyword">...</span><span class="comment">  </span>
                        <span class="string">'metaData'</span>,metatxt);
            <span class="keyword">if</span> isempty(newds), <span class="keyword">return</span>; <span class="keyword">end</span>   <span class="comment">%trap error before assigning to obj</span>
            obj.ModelData{irec} = newds;
            
            <span class="comment">%OR </span>
            
            <span class="comment">%create timeseries with assignments as needed</span>
<span class="comment">%             tsc = setCollection(obj,results,...</span>
<span class="comment">%                         'xyzData', xycoords,...</span>
<span class="comment">%                         'Time',modeltime,...  </span>
<span class="comment">%                         'metaData',metatxt);</span>
<span class="comment">%             if isempty(tsc), return; end   %trap error before assigning to obj</span>
<span class="comment">%             obj.mtsc{irec} = tsc;</span>
          
<span class="comment">%--------------------------------------------------------------------------</span>
<span class="comment">% End of Model code</span>
<span class="comment">%--------------------------------------------------------------------------                         </span>
            <span class="comment">%write results</span>
            Results.saveResults(mobj,handle,obj);
            ModelUI.myDialog(<span class="string">'Run complete'</span>);
            DrawMap(mobj)
        <span class="keyword">end</span>     
    <span class="keyword">end</span> 
<span class="comment">%%</span>
    <span class="keyword">methods</span>
        <span class="keyword">function</span> tabPlot(obj,src,mobj,inp)
            <span class="comment">%generate plot for display on Plot tab</span>
            <span class="comment">%sample code for models that inherit DSDataSet</span>
            <span class="comment">%models that inherit TSDataSet can use the default in TSDataSet</span>
            <span class="comment">%data is retrieved by GUIinterface.getTabData            </span>
            propid = 1;  <span class="comment">%id for property that holds the data in obj.ResDef.DataVar cell</span>
            selecteddata = obj.(inp.dprop{propid}){inp.id_rec};
            <span class="comment">%--------------------------------------------------------------</span>
            <span class="comment">%extract data vectors, eg:</span>
            t = getRowNames(obj,selecteddata);
            z = selecteddata{:,1};
            <span class="comment">%surface plot of 3D form</span>
            ht = findobj(src,<span class="string">'Type'</span>,<span class="string">'axes'</span>);
            delete(ht);
            ax = axes(<span class="string">'Parent'</span>,src,<span class="string">'Tag'</span>,<span class="string">'MyPlot'</span>);
            plot(ax,t,z);          
            title (inp.casedesc);
            ax.Color = [0.96,0.96,0.96];  <span class="comment">%needs to be set after plot            </span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% ModelUI - Getting Started
% The steps below outline how to setup a bespoke application of ModelUI
% by modifying the default UI. How to develop more complex UIs is explained
% more in the <matlab:open_manual ModelUI manual>.
%%
% # Decide on what components are needed. These might include: <br>
%   o UI - the main interface for the application  <br>
%   o Data import - load different types of data <br>
%   o Properties input - define properties needed for application <br>
%   o Model(s) - the models to be run by the application.  <br>
% # Give names to each component, e.g.: <br>
%   ModelUI, demoData, demoProps, demoModel
% # Copy the class templates for the components from here to your working folder
% # Create classes for each component by editing the templates as set out for each template below.

%% Main UI
% Text
%
% <include>../utils/UseUI_template.m</include>
%
%% Data import
% text
%
% <include>../utils/DataImport_template.m</include>
%
%% Data properties 
% For each set of _input properties_, define a classname and edit the
% template where indicated using the classname. Define the _input
% properties_ required in the properties block and provide a description 
% (used in the input UI) for each property as a cell array of strings in 
% the PropertyLabels property.
%
% <include>../utils/PropsInput_template.m</include>
%
%% Models
% text
%
% <include>../utils/Model_template</include>
%
	






##### SOURCE END #####
--></body></html>